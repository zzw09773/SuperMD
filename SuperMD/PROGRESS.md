# SuperMD é–‹ç™¼é€²åº¦è¿½è¹¤

> **æœ€å¾Œæ›´æ–°**: 2025-10-06
> **ç‰ˆæœ¬**: 0.2.0
> **ç‹€æ…‹**: Phase 1-3 å®Œæˆï¼ŒPhase 3 å¢å¼·ç‰ˆå®Œæˆ

## ğŸ¯ å°ˆæ¡ˆæ¦‚è¦½

SuperMD æ˜¯ä¸€å€‹ç¾ä»£åŒ–çš„å”ä½œ Markdown ç·¨è¼¯å™¨ï¼Œæ•´åˆé›™æ¨¡å¼ AI åŠ©æ‰‹ï¼ˆGPT-5 Chat + Deep Researchï¼‰ã€å³æ™‚å”ä½œåŠŸèƒ½ã€ä»¥åŠå®Œå–„çš„æ–‡æª”ç®¡ç†ç³»çµ±ã€‚

## ğŸ“Š æ•´é«”é€²åº¦

| Phase | ç‹€æ…‹ | å®Œæˆåº¦ | èªªæ˜ |
|-------|------|--------|------|
| Phase 1 | âœ… å®Œæˆ | 100% | æ ¸å¿ƒç·¨è¼¯å™¨èˆ‡åŸºç¤åŠŸèƒ½ |
| Phase 2 | âœ… å®Œæˆ | 100% | AI åŠ©æ‰‹èˆ‡å”ä½œåŠŸèƒ½ |
| Phase 3 | âœ… å®Œæˆ | 100% | å°ˆæ¡ˆç®¡ç†èˆ‡ UI å„ªåŒ– |
| **Phase 3 å¢å¼·** | âœ… å®Œæˆ | 100% | **DOCX ä¿®å¾© + é è¦½å„ªåŒ– + è‡ªå‹•å®Œæˆ** |
| Phase 4 | â¸ï¸ è¦åŠƒä¸­ | 0% | è³‡æ–™æŒä¹…åŒ–èˆ‡èªè­‰ |
| Phase 5+ | ğŸ“‹ å¾…è¦åŠƒ | 0% | é€²éšåŠŸèƒ½ |

---

## âœ… Phase 3 å¢å¼·ç‰ˆ: UI/UX å„ªåŒ–èˆ‡å°å‡ºä¿®å¾© (2025-10-06 å®Œæˆ) ğŸ‰

### 3A. DOCX å°å‡ºä¿®å¾©
- âœ… **ä¿®å¾© `asBlob is not a function` éŒ¯èª¤**
  - ç§»é™¤æœ‰å•é¡Œçš„ `html-docx-js` å¥—ä»¶
  - æ•´åˆ `@turbodocx/html-to-docx` v1.15.3
  - æ­£ç¢ºè™•ç† Buffer/ArrayBuffer/Blob è½‰æ›
- âœ… **ä¿®å¾© DOCX æ–‡ä»¶æå£å•é¡Œ**
  - ç§»é™¤é‡è¤‡çš„æ¨™é¡Œé¡¯ç¤º
  - æ­£ç¢ºåµŒå…¥ base64 åœ–ç‰‡
  - æ”¯æ´å®Œæ•´çš„ Markdown â†’ HTML â†’ DOCX è½‰æ›æµç¨‹
- âœ… **æ¸¬è©¦ç¢ºèª**: Word å¯æ­£å¸¸é–‹å•Ÿä¸¦é¡¯ç¤ºæ‰€æœ‰å…§å®¹

### 3B. é è¦½çª—æ ¼å„ªåŒ–
- âœ… **å®‰è£ Tailwind Typography æ’ä»¶**
  - `npm install -D @tailwindcss/typography`
  - é…ç½® `tailwind.config.js`
- âœ… **æ¨™é¡Œéšå±¤è¦–è¦ºåŒ–** (è§£æ±ºã€Œå¤§æ¨™å°æ¨™ç„¡å€åˆ†ã€å•é¡Œ)
  - H1: 4xl å­—é«”ã€ç²—é«”ã€ä¸‹é‚Šæ¡†ã€æœ€å¤§é–“è·
  - H2: 3xl å­—é«”ã€ç²—é«”ã€ä¸‹é‚Šæ¡†ã€å¤§é–“è·
  - H3: 2xl å­—é«”ã€ç²—é«”ã€ä¸­é–“è·
  - H4: xl å­—é«”ã€ç²—é«”ã€å°é–“è·
  - H5-H6: éæ¸›å­—é«”ã€ç²—é«”
- âœ… **å®Œæ•´å…ƒç´ æ¨£å¼è‡ªè¨‚**
  - æ®µè½: è¡Œé«˜ 1.75ã€é©ç•¶é–“è·
  - åˆ—è¡¨: ç¸®æ’ã€é …ç›®ç¬¦è™Ÿã€é–“è·å„ªåŒ–
  - å¼•ç”¨: å·¦å´ç´«è‰²é‚Šæ¡†ã€æ–œé«”ã€èƒŒæ™¯è‰²
  - ç¨‹å¼ç¢¼: èƒŒæ™¯è‰²ã€åœ“è§’ã€å…§è·
  - åœ–ç‰‡: åœ“è§’ã€é™°å½±ã€è‡ªé©æ‡‰
  - è¡¨æ ¼: é‚Šæ¡†ã€æ¨™é¡ŒèƒŒæ™¯ã€æ–‘é¦¬ç´‹
  - é€£çµ: è—è‰²ã€hover ä¸‹åŠƒç·š
- âœ… **æ·±è‰²æ¨¡å¼å®Œæ•´æ”¯æ´**
- âœ… **CodiMD é¢¨æ ¼è¦–è¦ºæ•ˆæœ**

### 3C. Markdown è‡ªå‹•å®ŒæˆåŠŸèƒ½
- âœ… **æ•´åˆ @codemirror/autocomplete**
- âœ… **å»ºç«‹è‡ªè¨‚è‡ªå‹•å®Œæˆç³»çµ±**
  - 30+ é è¨­ç‰‡æ®µï¼ˆæ¨™é¡Œã€æ ¼å¼ã€åˆ—è¡¨ã€ç¨‹å¼ç¢¼ç­‰ï¼‰
  - ä¸­æ–‡èªªæ˜æ–‡å­—
  - æ™ºæ…§è§¸ç™¼ï¼ˆè¼¸å…¥ç‰¹æ®Šå­—ç¬¦ï¼‰
- âœ… **æ”¯æ´çš„èªæ³•**
  - æ¨™é¡Œ: `#`, `##`, `###` (H1-H6)
  - æ ¼å¼: `**bold**`, `*italic*`, `~~strikethrough~~`, `` `code` ``
  - é€£çµ: `[link](url)`, `![image](url)`
  - åˆ—è¡¨: `- item`, `1. item`, `- [ ] task`
  - ç¨‹å¼ç¢¼: `` ```javascript ``, `` ```python ``, `` ```typescript ``
  - å…¶ä»–: `> quote`, `---`, `table`, `` ```mermaid ``
- âœ… **ä½¿ç”¨è€…é«”é©—**
  - è‡ªå‹•è§¸ç™¼ï¼ˆactivateOnTyping: trueï¼‰
  - æ‰‹å‹•è§¸ç™¼ï¼ˆCtrl/Cmd+Spaceï¼‰
  - éµç›¤å°èˆªï¼ˆä¸Šä¸‹éµé¸æ“‡ï¼‰
  - æœ€å¤šé¡¯ç¤º 10 å€‹é¸é …

### 3D. ä¾è³´æ›´æ–°èˆ‡ä¿®å¾©
- âœ… å®‰è£ `@tailwindcss/typography@0.5.x`
- âœ… å®‰è£ `@turbodocx/html-to-docx@1.15.3`
- âœ… å®‰è£ `@codemirror/autocomplete@6.x`
- âœ… å®‰è£ `@types/multer` (ä¿®å¾© TypeScript éŒ¯èª¤)
- âœ… ç§»é™¤ `html-docx-js`, `html-to-docx` (èˆŠç‰ˆ)
- âœ… ä¿®å¾© Prisma å°å…¥å•é¡Œ (named â†’ default export)

---

## âœ… Phase 1: åŸºç¤åŠŸèƒ½ (å·²å®Œæˆ)

### 1.1 ç·¨è¼¯å™¨æ ¸å¿ƒ
- âœ… CodeMirror 6 æ•´åˆ
- âœ… Markdown èªæ³•é«˜äº®
- âœ… å³æ™‚é è¦½ï¼ˆåˆ†å‰²è¦–åœ–ï¼‰
- âœ… ç·¨è¼¯å™¨å·¥å…·åˆ—ï¼ˆ7 å€‹æ ¼å¼åŒ–æŒ‰éˆ•ï¼‰
  - Bold, Italic, Code, Link, Image, Lists
- âœ… è‡ªå‹•å„²å­˜åŠŸèƒ½
- âœ… å„²å­˜ç‹€æ…‹æŒ‡ç¤ºå™¨

### 1.2 å”ä½œåŠŸèƒ½
- âœ… Socket.IO å³æ™‚é€šè¨Š
- âœ… Y.js CRDT æ•´åˆ
- âœ… å¤šç”¨æˆ¶ç·¨è¼¯
- âœ… å”ä½œç‹€æ…‹é¡¯ç¤ºï¼ˆé€£ç·šç‹€æ…‹ + ç”¨æˆ¶è¨ˆæ•¸ï¼‰
- âœ… ç”¨æˆ¶æ¸¸æ¨™åŒæ­¥

### 1.3 åŒ¯å‡ºåŠŸèƒ½
- âœ… 5 ç¨®æ ¼å¼åŒ¯å‡º
  - âœ… Markdown (.md)
  - âœ… HTML (.html)
  - âœ… PDF (.pdf)
  - âœ… Word (.docx)
  - âœ… ç´”æ–‡å­— (.txt)
- âœ… ä¸‹æ‹‰é¸å–® UI
- âœ… æª”æ¡ˆä¸‹è¼‰åŠŸèƒ½

### 1.4 AI èŠå¤©åŠ©æ‰‹
- âœ… GPT-5 API æ•´åˆ
- âœ… èŠå¤©ä»‹é¢ (ChatBotPanel)
- âœ… ä¸²æµå›æ‡‰
- âœ… è¨Šæ¯æ­·å²è¨˜éŒ„
- âœ… é›™æ¨¡å¼åˆ‡æ› (Chat/Research)

---

## âœ… Phase 2: AI æ·±åº¦ç ”ç©¶åŠŸèƒ½ (å·²å®Œæˆ)

### 2.1 Research Agent æ¶æ§‹
- âœ… LangGraph ReAct Agent
- âœ… LangChain Tool Integration
- âœ… ä¸²æµå›æ‡‰ (Server-Sent Events)
- âœ… å·¥å…·å‘¼å«è¿½è¹¤

### 2.2 ç ”ç©¶å·¥å…·
- âœ… **Google Custom Search API**
  - ä½¿ç”¨å®˜æ–¹ Google API (é SerpAPI)
  - JWT æœå‹™å¸³æˆ¶èªè­‰
  - æ¯æ¬¡æŸ¥è©¢è¿”å› 5 å€‹çµæœ
  - è‡ªå‹•æå–ä¾†æº URL
- âœ… **è¨ˆç®—æ©Ÿå·¥å…·**
  - æ•¸å­¸é‹ç®—æ”¯æ´
  - è¤‡é›œè¡¨é”å¼è¨ˆç®—
- âœ… **æ–‡ä»¶æœå°‹å·¥å…·**
  - æœå°‹ç•¶å‰æ–‡ä»¶å…§å®¹
  - ç›¸é—œæ€§æ’åº

### 2.3 Research UI
- âœ… æ¨¡å¼åˆ‡æ›æŒ‰éˆ• (Chat/Research)
- âœ… **è·‘é¦¬ç‡ˆæ€è€ƒéç¨‹é¡¯ç¤º**
  - ç´«è‰²æ¼¸å±¤èƒŒæ™¯
  - 3 é»è·³å‹•å‹•ç•«
  - è„ˆè¡é™°å½±æ•ˆæœ
  - å³æ™‚é¡¯ç¤ºæ¨ç†æ­¥é©Ÿ
- âœ… ä¾†æºå¼•ç”¨é¡¯ç¤º
  - æœ€å¤šé¡¯ç¤º 5 å€‹ä¾†æº
  - å¯é»æ“Šé€£çµ
  - ä¾†æºè¨ˆæ•¸æç¤º

### 2.4 API ä¿®å¾©
- âœ… GPT-5 åƒæ•¸ä¿®æ­£
  - `max_tokens` â†’ `max_completion_tokens`
  - `temperature: 0.7` â†’ `temperature: 1`
- âœ… Research API è·¯ç”±ä¿®æ­£
  - `POST /query` â†’ `GET /query` (SSE ç›¸å®¹)
  - Query åƒæ•¸è™•ç†

---

## âœ… Phase 3: å°ˆæ¡ˆç®¡ç† (å·²å®Œæˆ)

### 3.1 å°ˆæ¡ˆå´é‚Šæ¬„
- âœ… ChatGPT é¢¨æ ¼çµ„ç¹”çµæ§‹
- âœ… **å°ˆæ¡ˆç®¡ç†**
  - å»ºç«‹æ–°å°ˆæ¡ˆæŒ‰éˆ•
  - å±•é–‹/æ”¶åˆå°ˆæ¡ˆè³‡æ–™å¤¾
  - å°ˆæ¡ˆå…§æ–‡ä»¶åˆ—è¡¨
- âœ… **æœªåˆ†é¡æ–‡ä»¶å€**
  - ç¨ç«‹é¡¯ç¤ºå€åŸŸ
  - æ”¯æ´æ‹–æ›³é€²å‡º

### 3.2 æ‹–æ›³åŠŸèƒ½
- âœ… æ‹–æ›³æ–‡ä»¶åˆ°å°ˆæ¡ˆå…§
- âœ… æ‹–æ›³æ–‡ä»¶åˆ°æœªåˆ†é¡å€
- âœ… è·¨å°ˆæ¡ˆç§»å‹•æ–‡ä»¶
- âœ… è¦–è¦ºå›é¥‹ï¼ˆHover æ•ˆæœï¼‰

### 3.3 UI/UX æ”¹é€²
- âœ… è³‡æ–™å¤¾åœ–ç¤º (Folder icon)
- âœ… æ–‡ä»¶åœ–ç¤º (File icon)
- âœ… é¸ä¸­ç‹€æ…‹é«˜äº®
- âœ… æ·±è‰²æ¨¡å¼æ”¯æ´

---

## ğŸ”§ æŠ€è¡“æ¶æ§‹

### Frontend
```
client/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â”‚   â””â”€â”€ ChatBotPanel.tsx          âœ… é›™æ¨¡å¼ + å‹•ç•«
â”‚   â”‚   â”œâ”€â”€ editor/
â”‚   â”‚   â”‚   â”œâ”€â”€ MarkdownEditor.tsx        âœ… forwardRef + å›èª¿
â”‚   â”‚   â”‚   â”œâ”€â”€ EditorToolbar.tsx         âœ… 7 å€‹æ ¼å¼åŒ–æŒ‰éˆ•
â”‚   â”‚   â”‚   â””â”€â”€ PreviewPane.tsx           âœ… å³æ™‚é è¦½
â”‚   â”‚   â”œâ”€â”€ sidebar/
â”‚   â”‚   â”‚   â””â”€â”€ ProjectSidebar.tsx        âœ… å°ˆæ¡ˆç®¡ç†
â”‚   â”‚   â”œâ”€â”€ collaboration/
â”‚   â”‚   â”‚   â””â”€â”€ CollaborationStatus.tsx   âœ… é€£ç·šç‹€æ…‹
â”‚   â”‚   â”œâ”€â”€ common/
â”‚   â”‚   â”‚   â””â”€â”€ SaveStatus.tsx            âœ… å„²å­˜ç‹€æ…‹
â”‚   â”‚   â””â”€â”€ layout/
â”‚   â”‚       â””â”€â”€ MainLayout.tsx            âœ… ä¸»ä½ˆå±€
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ useChat.ts                    âœ… Chat + Research
â”‚   â”‚   â”œâ”€â”€ useAutoSave.ts                âœ… è‡ªå‹•å„²å­˜
â”‚   â”‚   â”œâ”€â”€ useCollaboration.ts           âœ… å³æ™‚å”ä½œ
â”‚   â”‚   â””â”€â”€ useKeyboardShortcuts.ts       âœ… éµç›¤å¿«æ·éµ
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ index.ts                      âœ… TypeScript é¡å‹
```

### Backend
```
server/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â””â”€â”€ researchAgent.ts              âœ… LangGraph Agent
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ chat.ts                       âœ… GPT-5 Chat
â”‚   â”‚   â”œâ”€â”€ research.ts                   âœ… Research SSE
â”‚   â”‚   â”œâ”€â”€ documents.ts                  âœ… CRUD
â”‚   â”‚   â””â”€â”€ folders.ts                    âœ… CRUD
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ openaiService.ts              âœ… GPT-5 ä¿®æ­£
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â””â”€â”€ memoryStore.ts                âœ… In-memory DB
â”‚   â””â”€â”€ index.ts                          âœ… Express + Socket.IO
â”œâ”€â”€ google-credentials.json               âœ… Google æœå‹™å¸³æˆ¶
â””â”€â”€ .env                                  âœ… API Keys
```

---

## ğŸ› å·²ä¿®å¾©çš„é‡å¤§å•é¡Œ

### Phase 3 å¢å¼· - å°å‡ºèˆ‡ UI å•é¡Œ (2025-10-06)
1. **DOCX å°å‡ºéŒ¯èª¤: `asBlob is not a function`**
   - âŒ å•é¡Œ: `html-docx-js` å¥—ä»¶å°å…¥æ–¹å¼éŒ¯èª¤
   - âœ… è§£æ±º: ä¿®æ­£å°å…¥èªæ³•ã€å˜—è©¦å¤šç¨®æ–¹æ¡ˆ
   - âœ… æœ€çµ‚: åˆ‡æ›åˆ° `@turbodocx/html-to-docx`

2. **DOCX å°å‡ºéŒ¯èª¤: `Neither Blob nor Buffer are accessible`**
   - âŒ å•é¡Œ: `html-docx-js` åœ¨ Node.js ç’°å¢ƒç„¡æ³•æ­£å¸¸é‹ä½œ
   - âœ… è§£æ±º: åˆ‡æ›åˆ° `@turbodocx/html-to-docx` (æ›´å¥½çš„ Node.js æ”¯æ´)

3. **DOCX æ–‡ä»¶æå£å•é¡Œ**
   - âŒ å•é¡Œ: Word ç„¡æ³•é–‹å•Ÿç”Ÿæˆçš„æ–‡ä»¶
   - âœ… è§£æ±º: æ­£ç¢ºè™•ç† ArrayBuffer/Buffer/Blob è½‰æ›

4. **DOCX æ¨™é¡Œé‡è¤‡é¡¯ç¤º**
   - âŒ å•é¡Œ: æ¨™é¡Œåœ¨æ–‡ä»¶ä¸­é¡¯ç¤ºå…©æ¬¡
   - âœ… è§£æ±º: ç§»é™¤ HTML body ä¸­çš„é¡å¤– `<h1>` æ¨™ç±¤

5. **é è¦½çª—æ ¼ Markdown æœªæ­£ç¢ºæ¸²æŸ“**
   - âŒ å•é¡Œ: `prose` é¡åˆ¥æ²’æœ‰æ¨£å¼æ•ˆæœï¼Œé¡¯ç¤ºåŸå§‹ HTML
   - âœ… è§£æ±º: å®‰è£ä¸¦é…ç½® `@tailwindcss/typography` æ’ä»¶

6. **æ¨™é¡Œéšå±¤ç„¡å€åˆ†**
   - âŒ å•é¡Œ: H1-H6 å¤§å°ç›¸åŒï¼Œç„¡æ³•å€åˆ†éšå±¤
   - âœ… è§£æ±º: è‡ªè¨‚ ReactMarkdown componentsï¼Œæ·»åŠ æ˜ç¢ºæ¨£å¼

7. **TypeScript ç·¨è­¯éŒ¯èª¤: ç¼ºå°‘ @types/multer**
   - âŒ å•é¡Œ: multer æ¨¡çµ„ç„¡å‹åˆ¥å®šç¾©
   - âœ… è§£æ±º: `npm install --save-dev @types/multer --legacy-peer-deps`

8. **Prisma å°å…¥éŒ¯èª¤**
   - âŒ å•é¡Œ: `import { prisma }` å ±éŒ¯ï¼ˆnamed export ä¸å­˜åœ¨ï¼‰
   - âœ… è§£æ±º: ä¿®æ”¹ç‚º `import prisma` (default export)

### Phase 1-3 - æ—©æœŸå•é¡Œ (2025-10-04)
9. **Copilot `git clean -fd` ç½é›£**
   - âœ… é‡å»ºæ‰€æœ‰è¢«åˆªé™¤çš„æª”æ¡ˆ
   - âœ… æ¢å¾© Research Agent
   - âœ… æ¢å¾© Google æ†‘è­‰

10. **Frontend ä¾è³´ç¼ºå¤±**
    - âœ… `react-markdown` æ¨¡çµ„è§£æéŒ¯èª¤
    - âœ… é‡æ–°å®‰è£ 843 å€‹å¥—ä»¶

11. **GPT-5 API åƒæ•¸éŒ¯èª¤**
    - âœ… `max_tokens` â†’ `max_completion_tokens`
    - âœ… `temperature` å¿…é ˆç‚º 1

12. **Research API 404 éŒ¯èª¤**
    - âœ… POST â†’ GET (SSE ç›¸å®¹)

---

## ğŸš€ ç•¶å‰é‹è¡Œç‹€æ…‹

### æœå‹™ç‹€æ…‹
- âœ… **Frontend**: http://localhost:5174 (é‹è¡Œä¸­)
- âœ… **Backend**: http://localhost:3000 (é‹è¡Œä¸­)
- âœ… **WebSocket**: å·²é€£æ¥
- âœ… **Research API**: å¯é‹ä½œ

### æ¸¬è©¦ç¢ºèª
```bash
# Backend Health Check
curl http://localhost:3000/health
# âœ… {"status":"ok","timestamp":"2025-10-04T13:50:13.856Z"}

# Research Status
curl http://localhost:3000/api/research/status
# âœ… {"status":"operational","features":["calculator","google_search","document_search"]}
```

---

## ğŸ“‹ ä¸‹ä¸€æ­¥ Roadmap

### Phase 4: è³‡æ–™æŒä¹…åŒ– (æœªä¾†)
- [ ] å®Œæˆ Phase 4 Spikeï¼ˆè©³è¦‹ `docs/phase-4-spike.md`ï¼‰
- [ ] Prisma è³‡æ–™æºæ”¹ç”¨ PostgreSQL ä¸¦æä¾› SQLite fallback
- [ ] ä¸€æ¬¡æ€§è³‡æ–™åŒ¯å…¥è…³æœ¬ + é‚„åŸæµç¨‹
- [ ] æ¬Šé™ APIï¼ˆDocumentPermission guardï¼‰èˆ‡å‰ç«¯å”¯è®€/åˆ†äº«ä»‹é¢
- [ ] å¾Œç«¯/å‰ç«¯æ¸¬è©¦éª¨æ¶ï¼ˆVitest + Supertest / RTLï¼‰
- [ ] RAG å¿«å–èˆ‡å‘é‡ fallback/ç›£æ§
- [ ] API Key è¨­å®šé¢æ¿åŸå‹

### Phase 5: é€²éšåŠŸèƒ½ (æœªä¾†)
- [ ] ç‰ˆæœ¬æ­·å² (Git-like)
- [ ] é›¢ç·šæ”¯æ´ (PWA)
- [ ] å¤šèªè¨€æ”¯æ´ (i18n)
- [ ] è‡ªè¨‚ä¸»é¡Œç³»çµ±

### Phase 6: æ•ˆèƒ½å„ªåŒ– (æœªä¾†)
- [ ] React è™›æ“¬åŒ– (å¤§å‹æ–‡ä»¶åˆ—è¡¨)
- [ ] åœ–ç‰‡æœ€ä½³åŒ–èˆ‡ CDN
- [ ] ç¨‹å¼ç¢¼åˆ†å‰² (Code Splitting)
- [ ] Service Worker å¿«å–

### Phase 7: éƒ¨ç½²èˆ‡ç›£æ§ (æœªä¾†)
- [ ] Docker å®¹å™¨åŒ–
- [ ] CI/CD Pipeline
- [ ] éŒ¯èª¤è¿½è¹¤ (Sentry)
- [ ] æ•ˆèƒ½ç›£æ§ (Analytics)

---

## ğŸ›  Phase 4 è¦åŠƒææ¡ˆ (2025-10-06)

### 4.1 è³‡æ–™æŒä¹…åŒ–å‡ç´šï¼ˆSQLite â†’ PostgreSQLï¼‰
- **ç¾æ³è©•ä¼°**ï¼šPrisma ç›®å‰ä½¿ç”¨ SQLiteï¼ˆ`schema.prisma`ï¼‰ï¼Œè€Œ RAG æµç¨‹å·²æ¡ç”¨ PostgreSQL + pgvectorã€‚Phase 4 ç›®æ¨™æ˜¯çµ±ä¸€ä¸»è³‡æ–™åº«ï¼Œé¿å…é›™è³‡æ–™æºé€ æˆä¸€è‡´æ€§å•é¡Œã€‚
- **å»ºè­°æ­¥é©Ÿ**ï¼š
  1. å»ºç«‹ PostgreSQL åŸ·è¡Œå€‹é«”ä¸¦è¨­å®š `DATABASE_URL=postgresql://`ï¼ˆå¯æ²¿ç”¨ pgvector å¢é›†æˆ–å»ºç«‹ç¨ç«‹è³‡æ–™åº«ï¼‰ã€‚
  2. æ›´æ–° `schema.prisma` çš„ datasource providerï¼ŒåŸ·è¡Œ `npx prisma migrate diff` é©—è­‰å·®ç•°ï¼Œä¸¦å»ºç«‹é¦–æ‰¹é·ç§»è…³æœ¬ã€‚
  3. æ’°å¯«ä¸€æ¬¡æ€§é·ç§»è…³æœ¬ï¼ˆNode.js + Prismaï¼‰å°‡ SQLite `dev.db` åŒ¯å‡ºå¾Œå¯«å…¥ PostgreSQLï¼›åŒæ­¥è™•ç†æ–‡ä»¶ã€å°ˆæ¡ˆã€ç›®éŒ„ã€èŠå¤©ç´€éŒ„ç­‰é—œè¯ã€‚
  4. æ›´æ–° `.env`ã€`docker-compose`ï¼ˆå¦‚éœ€è¦ï¼‰ä¸¦åœ¨ `.github/copilot-instructions.md` è£œå……æ–°ç’°å¢ƒè®Šæ•¸èˆ‡å•Ÿå‹•æµç¨‹ã€‚
  5. PR æµç¨‹æä¾›è³‡æ–™å‚™æ´æ–¹æ¡ˆï¼šæœ¬åœ° fallback è‡³ SQLiteï¼ˆ`DATABASE_URL=file:./dev.db`ï¼‰æˆ–æä¾› `docker-compose.db.yml` æ–¹ä¾¿ä¸€éµå•Ÿå‹•ã€‚

### 4.2 æ¬Šé™èˆ‡èªè­‰æ•´åˆ
- **ç¾æ³è©•ä¼°**ï¼š`DocumentPermission` æ¨¡å‹å·²å­˜åœ¨ï¼Œä½† API ä»ä»¥ä½¿ç”¨è€…ç‚ºä¸­å¿ƒï¼Œå°šæœªçœŸæ­£è½å¯¦å…±äº«èˆ‡æ¬Šé™æª¢æŸ¥ã€‚
- **å»ºè­°å¯¦ä½œ**ï¼š
  - æ–¼ `authMiddleware` æ³¨å…¥çš„ `req.user`ï¼Œåœ¨ `routes/document*`ã€`routes/project*`ã€`routes/chatHistory.ts` åŠ å…¥ `DocumentPermission` æª¢æ ¸ï¼ˆread/writeï¼‰ã€‚
  - å»ºç«‹å…±ç”¨ helperï¼ˆ`canReadDocument`, `canEditDocument`ï¼‰ä»¥åŠ Prisma include ç¯„æœ¬ï¼Œé¿å…é‡è¤‡æŸ¥è©¢é‚è¼¯ã€‚
  - å®¢æˆ¶ç«¯åœ¨ `ProjectSidebar`ã€`MarkdownEditor` ç­‰çµ„ä»¶åŠ å…¥å”¯è®€æ¨¡å¼ï¼ˆç¦ç”¨å¯«å…¥ã€é¡¯ç¤ºé–é ­ï¼‰ã€‚
  - æ–°å¢åˆ†äº« APIï¼ˆä¾ email é‚€è«‹ â†’ å»ºç«‹ `DocumentPermission`ï¼‰ï¼Œä¸¦åœ¨ UI é¡¯ç¤ºæ¬Šé™å¾½ç« æˆ– Tooltipã€‚

### 4.3 è‡ªå‹•åŒ–æ¸¬è©¦ç­–ç•¥
- **Backend**ï¼šæ¡ç”¨ Vitest æˆ– Jest + Supertest è¦†è“‹ `auth`, `documents`, `rag` è·¯ç”±ï¼›ä½¿ç”¨ Prisma Test Environmentï¼ˆæ¯æ¸¬è©¦å•Ÿå‹•äº¤æ˜“æˆ– SQLite in-memoryï¼‰ä¸¦ä»¥ `ioredis-mock` æ¨¡æ“¬å¿«å–ã€‚
- **Frontend**ï¼šåˆ©ç”¨ Vitest + React Testing Library æ¸¬è©¦ `ChatBotPanel` ä¸²æµæ¸²æŸ“ã€é¢æ¿æŠ˜ç–Šï¼Œä»¥åŠ `useChat` hook çš„ SSE é‚è¼¯ï¼ˆmock EventSourceï¼‰ã€‚
- **E2E**ï¼šå°å…¥ Playwrightï¼Œè‡ªå‹•åŒ–ã€Œç™»å…¥ â†’ é–‹å•Ÿæ–‡ä»¶ â†’ ä¸²æµå›ç­” â†’ åŒ¯å‡º DOCXã€ä¸»æµç¨‹ã€‚
- **CI**ï¼šGitHub Actions å»ºè­°æµç¨‹ `lint â†’ test â†’ build`ï¼›åˆ‡æ› PostgreSQL å¾Œéœ€åœ¨ workflow å•Ÿå‹• `services: postgres`ï¼Œä¸¦åŒ¯å…¥ init scriptã€‚

### 4.4 SSE æµç¨‹é‡é»
- **ç«¯é»**ï¼š
  - `/api/research/query`ï¼ˆGETï¼‰ï¼šLangGraph ReAct agentï¼›ä¸²æµäº‹ä»¶é¡å‹åŒ…å« `reasoning`ã€`tool_call`ã€`tool_result`ã€`chunk`ï¼Œæœ€å¾Œä»¥ `done` payloadï¼ˆ`fullResponse`ã€`toolCalls`ã€`sources`ï¼‰çµæŸã€‚
  - `/api/chat`ï¼ˆPOST, `stream=true`ï¼‰ï¼šOpenAI Chat Completion ä¸²æµï¼Œå‚³å› `{ chunk }` å­—ä¸²ä¸¦ä»¥ `[DONE]` æ”¶å°¾ã€‚
- **æ¡æ‰‹èˆ‡éŒ¯èª¤è™•ç†**ï¼šå…©ç«¯é»çš†è¨­å®š `Content-Type: text/event-stream`ã€`Cache-Control: no-cache`ã€`Connection: keep-alive`ã€‚ç•¶ä¾‹å¤–ç™¼ç”Ÿä¸” headers å·²é€å‡ºæ™‚ï¼Œä»¥ `data: {"error": "..."}` å‚³å›å¾Œç«‹å³ `res.end()`ï¼Œé¿å…å‰ç«¯æ›èµ·ã€‚
- **å‰ç«¯æ•´åˆæé†’**ï¼š`useChat.ts` éœ€è§£æ `[DONE]` äº‹ä»¶ã€ä¾äº‹ä»¶ `type` æ›´æ–° UIï¼›Research æ¨¡å¼åœ¨ `ChatBotPanel` é€é `type === 'reasoning'` æ§åˆ¶è·‘é¦¬ç‡ˆï¼Œ`sources` ç”¨æ–¼çµå°¾å¼•ç”¨å±•ç¤ºã€‚

### 4.5 RAG å‘é‡å„²å­˜ç­†è¨˜
- **è³‡æ–™è¡¨**ï¼š`rag_documents`ï¼ˆåŸå§‹æ–‡ä»¶ï¼‰èˆ‡ `rag_embeddings`ï¼ˆ1536 ç¶­å‘é‡ã€IVFFlat ç´¢å¼•ï¼‰ï¼Œçš†ç”± `initializePgVector()` å»ºç«‹ï¼Œä¸¦ä»¥ `document_id` é—œè¯ã€‚
- **æµç¨‹æ‘˜è¦**ï¼š
  1. `smartIndexDocument` â†’ `indexDocument`ï¼šRecursive splitter (1000/200) åˆ‡ç‰‡ï¼Œå‘¼å« `OpenAIEmbeddings.embedDocuments`ï¼Œé€ç­†å¯«å…¥å‘é‡è¡¨ã€‚
  2. `searchSimilarDocuments`ï¼šå…ˆæŸ¥ Redis å¿«å–ï¼ˆkey: `rag:search:<md5>`ï¼‰ï¼Œè‹¥ miss å‰‡è¨ˆç®— query embeddingï¼Œä½¿ç”¨ `<=>` cosine è·é›¢æ’åºã€‚
  3. Agentic RAG (`queryAgenticRAG`) å°‡çµæœåŒ…æˆ `knowledge_base_search` å·¥å…·è¼¸å‡ºï¼ŒLLM è² è²¬çµ„è£å›ç­”èˆ‡å¼•ç”¨ã€‚
- **Phase 4 é¢¨éšªæ§ç®¡**ï¼šå°‡ `CREATE EXTENSION vector` ç´å…¥ migrationï¼›ç‚º Redis ç•°å¸¸æ™‚æä¾› graceful fallbackï¼ˆç›´æ¥æŸ¥è³‡æ–™åº« + logï¼‰ï¼›é‡å°æ‰¹æ¬¡ upsert / re-index æ’°å¯«èƒŒæ™¯å·¥ä½œï¼ˆå¯æ”¾å…¥ `batchProcessor.ts`ï¼‰ã€‚

> ğŸ“Œ è«‹åœ¨é‡å¤§é‡æ§‹å‰åŒæ­¥æ›´æ–°æœ¬ç¯€èˆ‡ `.github/copilot-instructions.md`ï¼Œç¢ºä¿æ‰€æœ‰é–‹ç™¼è€…æŒæ¡æœ€æ–°å…±è­˜ã€‚

---

## ğŸ‰ å°ˆæ¡ˆäº®é»

### å‰µæ–°åŠŸèƒ½
1. **é›™æ¨¡å¼ AI åŠ©æ‰‹**
   - Chat æ¨¡å¼ï¼šå¿«é€Ÿå°è©± (GPT-5)
   - Research æ¨¡å¼ï¼šæ·±åº¦ç ”ç©¶ (Google + LangGraph)

2. **è¦–è¦ºåŒ–æ€è€ƒéç¨‹**
   - è·‘é¦¬ç‡ˆå‹•ç•«é¡¯ç¤ºæ¨ç†æ­¥é©Ÿ
   - å³æ™‚å·¥å…·å‘¼å«è¿½è¹¤
   - ä¾†æºè‡ªå‹•æå–èˆ‡å¼•ç”¨

3. **ChatGPT é¢¨æ ¼å°ˆæ¡ˆç®¡ç†**
   - ç›´è¦ºçš„æ‹–æ›³ä»‹é¢
   - å°ˆæ¡ˆåˆ†çµ„èˆ‡æœªåˆ†é¡å€
   - å³æ™‚æ›´æ–°ç‹€æ…‹

### æŠ€è¡“æˆå°±
- âœ… å®Œæ•´ TypeScript å‹åˆ¥å®‰å…¨
- âœ… React æœ€ä½³å¯¦è¸ (Hooks, forwardRef)
- âœ… SSE ä¸²æµæŠ€è¡“
- âœ… LangGraph ReAct Pattern
- âœ… å®˜æ–¹ Google API æ•´åˆ
- âœ… ç¾è§€çš„ Tailwind UI

---

## ğŸ“ æäº¤è¨˜éŒ„

```bash
git log --oneline -10

9ac6eed Fix Research API and add animated reasoning display
a57d66d Fix: Add missing onDocumentSelect prop destructuring
740d409 Add Project Management Sidebar and Research Mode Toggle
f303316 Fix useCollaboration hook to return users array
14cd574 Restore complete UI features after Copilot git clean
b577953 Initial commit: SuperMD - Collaborative Markdown Editor
```

---

## ğŸ™ è‡´è¬

- **OpenAI GPT-5**: å¼·å¤§çš„ AI å°è©±èƒ½åŠ›
- **Google Custom Search API**: å¯é çš„æœå°‹æœå‹™
- **LangChain/LangGraph**: å„ªç§€çš„ Agent æ¡†æ¶
- **React + Vite**: ç¾ä»£åŒ–å‰ç«¯å·¥å…·éˆ
- **Claude Code**: å°ˆæ¡ˆé–‹ç™¼å”åŠ© ğŸ¤–

---

## ğŸ“ˆ å°ˆæ¡ˆçµ±è¨ˆ

### ç¨‹å¼ç¢¼è¦æ¨¡ (2025-10-06)
- **ç¸½è¡Œæ•¸**: ~6,500+ è¡Œ (+1,500)
- **å‰ç«¯æª”æ¡ˆ**: 35+ å€‹å…ƒä»¶
- **å¾Œç«¯æª”æ¡ˆ**: 20+ å€‹è·¯ç”±/æœå‹™
- **ä¾è³´å¥—ä»¶**:
  - å‰ç«¯: 195 packages
  - å¾Œç«¯: 92 packages

### åŠŸèƒ½å®Œæˆåº¦
- **æ ¸å¿ƒç·¨è¼¯åŠŸèƒ½**: âœ… 100%
- **AI åŠ©æ‰‹**: âœ… 100%
- **å”ä½œåŠŸèƒ½**: âœ… 85% (åŸºç¤å®Œæˆï¼ŒCRDT åŒæ­¥å¾…å¯¦ä½œ)
- **å°å‡ºåŠŸèƒ½**: âœ… 100% (æ‰€æœ‰æ ¼å¼æ­£å¸¸)
- **UI/UX**: âœ… 98% (æŒçºŒå„ªåŒ–ä¸­)
- **è‡ªå‹•å®Œæˆ**: âœ… 100%

### æŠ€è¡“å‚µå‹™
- âš ï¸ PostgreSQL + pgvector æœªé…ç½® (RAG åŠŸèƒ½å—é™)
- âš ï¸ Y.js CRDT å³æ™‚åŒæ­¥å°šæœªå®Œæ•´å¯¦ä½œ
- âš ï¸ TypeScript ç·¨è­¯æœ‰éƒ¨åˆ†è­¦å‘Š (éé˜»å¡æ€§)
- âš ï¸ ä½¿ç”¨è€…èªè­‰ç³»çµ±éœ€è¦å¢å¼·

---

## ğŸ† é‡Œç¨‹ç¢‘æ™‚é–“ç·š

- **2025-10-04 æ—©ä¸Š**: Phase 1-2 å®Œæˆ
- **2025-10-04 ä¸‹åˆ**: Phase 3 å®Œæˆ + Copilot ç½é›£æ¢å¾©
- **2025-10-06 ä¸Šåˆ**: Phase 3 å¢å¼·é–‹å§‹
  - 09:00-10:00: DOCX å°å‡ºä¿®å¾©
  - 10:00-11:00: é è¦½çª—æ ¼å„ªåŒ–
  - 11:00-12:00: Markdown è‡ªå‹•å®Œæˆ
- **2025-10-06 ä¸­åˆ**: Phase 3 å¢å¼·å®Œæˆ (v0.2.0)

---

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè­°

### ç«‹å³å¯åš (æœ¬é€±):
1. âœ¨ **æ•¸å­¸å…¬å¼æ”¯æ´** - å®‰è£ KaTeXï¼Œæå‡å­¸è¡“å¯«ä½œèƒ½åŠ›
2. ğŸ“‘ **ç›®éŒ„è‡ªå‹•ç”Ÿæˆ** - è§£ææ¨™é¡Œçµæ§‹ï¼Œç”Ÿæˆå¯é»æ“Š TOC
3. ğŸ” **å…¨æ–‡æœå°‹** - å¯¦ä½œè·¨æ–‡æª”æœå°‹åŠŸèƒ½

### çŸ­æœŸè¦åŠƒ (2-4 é€±):
1. ğŸ·ï¸ **æ¨™ç±¤ç³»çµ±** - ç‚ºæ–‡æª”æ·»åŠ åˆ†é¡æ¨™ç±¤
2. ğŸ“‘ **å¤šæ¨™ç±¤é ** - åŒæ™‚ç·¨è¼¯å¤šå€‹æ–‡æª”
3. ğŸ¤ **Y.js CRDT** - å®Œæ•´çš„å³æ™‚å”ä½œåŒæ­¥

### é•·æœŸè¦åŠƒ (1-3 å€‹æœˆ):
1. ğŸ¤– **AI å¯«ä½œåŠ©æ‰‹** - GPT è¼”åŠ©å¯«ä½œ
2. ğŸ” **å®‰å…¨æ€§å¼·åŒ–** - OAuthã€åŠ å¯†ã€æ¬Šé™
3. ğŸ“± **PWA æ”¯æ´** - é›¢ç·šä½¿ç”¨èƒ½åŠ›

---

**ç‹€æ…‹**: âœ… Phase 3 å¢å¼·ç‰ˆå®Œæˆä¸¦æ¸¬è©¦é€šé
**ç‰ˆæœ¬**: v0.2.0
**æœ€å¾Œæ›´æ–°**: 2025-10-06 12:00
**ä¸‹æ¬¡æœƒè­°**: è¨è«– Phase 4A-C å„ªå…ˆé †åº
